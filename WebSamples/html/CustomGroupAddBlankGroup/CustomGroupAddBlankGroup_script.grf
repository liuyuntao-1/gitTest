Object Report
	Version='5.5.0.8'
	Title='Grid++Report'
	Object Font
		Name='宋体'
		Size=90000,0
		Weight=400
		Charset=134
	End
	InitializeScript='//将初始设为1\r\nReport.ParameterByName("CatalogNo").AsInteger = 1;'
	ProcessEndScript='//在所有数据遍历完成后，如果还有分级没有产生，则应该将剩余的分级产生\r\nvar CurCatalog = Report.ParameterByName("CatalogNo").AsInteger;\r\nwhile (CurCatalog <= 5)\r\n{\r\n    Report.DetailGrid.StartNewGroup(1);\r\n    ++CurCatalog;\r\n}'
	Object Printer
	End
	Object ImageList
		Image=894
000001000100101000323637303168030000160000002800000010000000200000000100180000000000000300004746
6C656D696E67000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000060000060000060000060000060000
000000000000000000000000000000000000000000000000000000060000060000A7FF00A7FF00A7FF00A7FF008EF000
060000060000000000000000000000000000000000000000060000C4FF00C4FF00BFFF00BFFF00BFFF00BFFF00BFFF00
C4FF008EF000060000000000000000000000000000060000C4FF00C4FF00E0FF00E6FF00E6FF00E6FF00E6FF00E0FF00
BFFF00C4FF008EF000060000000000000000000000060000C4FF00E6FF00E6FF00060000060000060000060000060000
E0FF00BFFF00C4FF00060000000000000000060000C4FF00E6FF00E6FF00060000E6FF00E6FF00E6FF00E6FF00E6FF00
060000E0FF00BFFF008EF00006000000000006000BFCFF00E6FF00060000E6FF00E6FF00E6FF00E6FF00E6FF00E6FF00
E6FF00060000BFFF00A7FF0006000000000006005FFEFF00E6FF00E6FF00E6FF00E6FF00E6FF00E6FF00E6FF00E6FF00
E6FF00E6FF00BFFF00A7FF0006000000000006005FFEFF0BFCFF00E6FF00E6FF00060000E6FF00E6FF00E6FF00060000
E6FF00E6FF00BFFF00A7FF00060000000000060093FFFF0BFCFF00E6FF00E6FF00060000E6FF00E6FF00E6FF00060000
E6FF00E6FF00BFFF008EF00006000000000000000006005FFEFF0BFCFF00E6FF00060000E6FF00E6FF00E6FF00060000
E6FF00E6FF00C4FF00060000000000000000000000060093FFFF5FFEFF0BFCFF00E6FF00E6FF00E6FF00E6FF00E6FF00
E6FF00C4FF008EF0000600000000000000000000000000000600CFFFFF93FFFF0BFCFF0BFCFF00E6FF00E6FF00E6FF00
C4FF008EF0000600000000000000000000000000000000000000000600000600CFFFFF93FFFF5FFEFF5FFEFF00C4FF00
060000060000000000000000000000000000000000000000000000000000000000060000060000060000060000060000
0000000000000000000000000000FFFFFFFFFC1FFFFFF007FFFFE003FFFFC001FFFFC001FFFF8000FFFF8000FFFF8000
FFFF8000FFFF8000FFFFC001FFFFC001FFFFE003FFFFF007FFFFFC1FFFFF
		Image=894
000001000100101000323637303168030000160000002800000010000000200000000100180000000000000300004746
6C656D696E67000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000060000060000060000060000060000
000000000000000000000000000000000000000000000000000000060000060000A7FF00A7FF00A7FF00A7FF008EF000
060000060000000000000000000000000000000000000000060000C4FF00C4FF00BFFF00BFFF00BFFF00BFFF00BFFF00
C4FF008EF000060000000000000000000000000000060000C4FF00C4FF00E0FF00E6FF00E6FF00E6FF00E6FF00E0FF00
BFFF00C4FF008EF000060000000000000000000000060000C4FF00E6FF00E6FF00E0FF002F00000600002F0000E0FF00
E0FF00BFFF00C4FF00060000000000000000060000C4FF00E6FF00E6FF00E6FF00E6FF00E6FF00E6FF00E6FF00E6FF00
E6FF00E0FF00BFFF008EF00006000000000006000BFCFF00E6FF00E6FF00E6FF00E6FF00E6FF00E6FF00E6FF00E6FF00
E6FF00E6FF00BFFF00A7FF0006000000000006005FFEFF00E6FF00E6FF00E6FF00060000E6FF00E6FF00E6FF00060000
E6FF00E6FF00BFFF00A7FF0006000000000006005FFEFF0BFCFF00E6FF00E6FF00060000E6FF00E6FF00E6FF00060000
E6FF00E6FF00BFFF00A7FF00060000000000060093FFFF0BFCFF00E6FF00E6FF00060000E6FF00E6FF00E6FF00060000
E6FF00E6FF00BFFF008EF00006000000000000000006005FFEFF0BFCFF00E6FF00060000E6FF00E6FF00E6FF00060000
E6FF00E6FF00C4FF00060000000000000000000000060093FFFF5FFEFF0BFCFF00E6FF00E6FF00E6FF00E6FF00E6FF00
E6FF00C4FF008EF0000600000000000000000000000000000600CFFFFF93FFFF0BFCFF0BFCFF00E6FF00E6FF00E6FF00
C4FF008EF0000600000000000000000000000000000000000000000600000600CFFFFF93FFFF5FFEFF5FFEFF00C4FF00
060000060000000000000000000000000000000000000000000000000000000000060000060000060000060000060000
0000000000000000000000000000FFFFFFFFFC1FFFFFF007FFFFE003FFFFC001FFFFC001FFFF8000FFFF8000FFFF8000
FFFF8000FFFF8000FFFFC001FFFFC001FFFFE003FFFFF007FFFFFC1FFFFF
		Image=894
000001000100101000323637303168030000160000002800000010000000200000000100180000000000000300004746
6C656D696E67000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000060000060000060000060000060000
000000000000000000000000000000000000000000000000000000060000060000A7FF00A7FF00A7FF00A7FF008EF000
060000060000000000000000000000000000000000000000060000C4FF00C4FF00BFFF00BFFF00BFFF00BFFF00BFFF00
C4FF008EF000060000000000000000000000000000060000C4FF00C4FF00060000E6FF00E6FF00E6FF00E6FF00E0FF00
060000C4FF008EF000060000000000000000000000060000C4FF00E6FF00E6FF00060000060000060000060000060000
E0FF00BFFF00C4FF00060000000000000000060000C4FF00E6FF00E6FF00E6FF00E6FF00E6FF00E6FF00E6FF00E6FF00
E6FF00E0FF00BFFF008EF00006000000000006000BFCFF00E6FF00E6FF00E6FF00E6FF00E6FF00E6FF00E6FF00E6FF00
E6FF00E6FF00BFFF00A7FF0006000000000006005FFEFF00E6FF00E6FF00060000060000E6FF00E6FF00E6FF00060000
060000E6FF00BFFF00A7FF0006000000000006005FFEFF0BFCFF00E6FF00E6FF00060000E6FF00E6FF00E6FF00060000
E6FF00E6FF00BFFF00A7FF00060000000000060093FFFF0BFCFF00060000E6FF00060000E6FF00E6FF00E6FF00060000
E6FF00060000BFFF008EF00006000000000000000006005FFEFF0BFCFF00060000E6FF00E6FF00E6FF00E6FF00E6FF00
060000E6FF00C4FF00060000000000000000000000060093FFFF5FFEFF0BFCFF00060000E6FF00E6FF00E6FF00060000
E6FF00C4FF008EF0000600000000000000000000000000000600CFFFFF93FFFF0BFCFF0BFCFF00E6FF00E6FF00E6FF00
C4FF008EF0000600000000000000000000000000000000000000000600000600CFFFFF93FFFF5FFEFF5FFEFF00C4FF00
060000060000000000000000000000000000000000000000000000000000000000060000060000060000060000060000
0000000000000000000000000000FFFFFFFFFC1FFFFFF007FFFFE003FFFFC001FFFFC001FFFF8000FFFF8000FFFF8000
FFFF8000FFFF8000FFFFC001FFFFC001FFFFE003FFFFF007FFFFFC1FFFFF
	End
	Object DetailGrid
		Object Recordset
			ConnectionString='XML'
			QuerySQL='xmlCustomGroup.txt'
			ProcessRecordScript='//根据金额划分等级\r\nvar Amount = Report.FieldByName("销售金额").AsFloat;\r\nvar Catalog = 1;\r\nif (Amount > 200000)\r\n    Catalog = 1;\r\nelse if (Amount > 15000)\r\n    Catalog = 2;\r\nelse if (Amount > 5000)\r\n    Catalog = 3;\r\nelse if (Amount > 1000)\r\n    Catalog = 4;\r\nelse\r\n    Catalog = 5;\r\n\r\n//根据金额产生当前记录数据的级别，如果是新级别，则产生新分组，新级别前无数据的级别也要产生分组\r\nvar CurCatalog = Report.ParameterByName("CatalogNo").AsInteger;\r\nwhile (CurCatalog <= Catalog)\r\n{\r\n    Report.DetailGrid.StartNewGroup(1);\r\n    ++CurCatalog;\r\n}\r\n'
			Items Field
				Item
					Name='产品编号'
					Type=Integer
					DBFieldName='ProductID'
				End
				Item
					Name='产品名称'
					DBFieldName='ProductName'
				End
				Item
					Name='销售金额'
					Type=Float
					Format='$#,##0.00'
					DBFieldName='Amount'
				End
			End
		End
		Items Column
			Item
				Name='ProductID'
				Width=3.78354
			End
			Item
				Name='ProductName'
				Width=4.57729
			End
			Item
				Name='Amount'
				Width=4.39208
			End
		End
		Object ColumnContent
			Height=0.582083
			Items ColumnContentCell
				Item
					Column='ProductID'
					DataField='产品编号'
				End
				Item
					Column='ProductName'
					DataField='产品名称'
				End
				Item
					Column='Amount'
					TextAlign=MiddleRight
					DataField='销售金额'
				End
			End
		End
		Object ColumnTitle
			BackColor=00ECEBD5
			Height=0.79375
			RepeatStyle=OnPage
			Items ColumnTitleCell
				Item
					GroupTitle=F
					Column='ProductID'
					Text='产品编号'
				End
				Item
					GroupTitle=F
					Column='ProductName'
					Text='产品名称'
				End
				Item
					GroupTitle=F
					Column='Amount'
					Text='销售金额'
				End
			End
		End
		Items Group
			Item
				Name='Group1'
				GroupBeginScript='var CatalogNo = Report.ParameterByName("CatalogNo");\r\nvar No = CatalogNo.AsInteger;\r\n\r\n//根据等级产生此等级的显示名称\r\nvar Text;\r\nif (No == 1)\r\n    Text = "抢手";\r\nelse if (No == 2)\r\n    Text = "畅销";\r\nelse if (No == 3)\r\n    Text = "一般";\r\nelse if (No == 4)\r\n    Text = "较差";\r\nelse\r\n    Text = "滞销";\r\nReport.Parameters("Catalog").AsString = Text;\r\n\r\n//每产生一个分组，级别号增一\r\nCatalogNo.AsInteger = CatalogNo.AsInteger+1;'
				Object GroupHeader
					Height=0.582083
					Object Font
						Name='宋体'
						Size=90000,0
						Bold=T
						Charset=134
					End
					Items Control
						Item
							Type=StaticBox
							Name='StaticBox3'
							Left=0.185208
							Width=1.61396
							Height=0.582083
							Text='分类等级：'
						End
						Item
							Type=StaticBox
							Name='CatalogBox'
							BackColor=00E1FFFF
							Left=1.79917
							Width=2.19604
							Height=0.582083
							Text='StaticBox6'
							Parameter='Catalog'
						End
					End
				End
				Object GroupFooter
					BackColor=00E1FFFF
					Height=1.40229
					Object Font
						Name='宋体'
						Size=90000,0
						Bold=T
						Charset=134
					End
					Items Control
						Item
							Type=StaticBox
							Name='StaticBox4'
							BackColor=White
							Left=1.79917
							Width=1.61396
							Height=0.582083
							Text='产品个数：'
						End
						Item
							Type=SummaryBox
							Name='Summary1'
							BackColor=White
							Left=3.41313
							Width=1.98438
							Height=0.582083
							SummaryFun=Count
						End
						Item
							Type=SummaryBox
							Name='Summary2'
							BackColor=White
							AlignColumn='Amount'
							Left=8.36083
							Width=4.41854
							Height=0.582083
							TextAlign=MiddleRight
							DataField='销售金额'
							Format='$#,##0.00'
						End
						Item
							Type=StaticBox
							Name='StaticBox5'
							BackColor=White
							Left=6.79979
							Width=1.5875
							Height=0.582083
							Text='金额小计：'
						End
						Item
							Type=StaticBox
							Name='StaticBox6'
							Left=6.79979
							Top=0.582083
							Width=1.5875
							Height=0.608542
							Text='金额平均：'
						End
						Item
							Type=SummaryBox
							Name='Summary3'
							AlignColumn='Amount'
							Left=8.36083
							Top=0.582083
							Width=4.41854
							Height=0.608542
							TextAlign=MiddleRight
							DataField='销售金额'
							SummaryFun=Avg
							Format='$#,##0.00'
						End
						Item
							Type=ShapeBox
							Name='GreenShapeBox'
							BackColor=White
							Left=1.79917
							Top=0.608542
							Width=0.79375
							Height=0.608542
							ShapeType=Circle
							FillColor=Green
							FillStyle=Normal
						End
						Item
							Type=ShapeBox
							Name='YellowShapeBox'
							BackColor=White
							Left=1.79917
							Top=0.608542
							Width=0.79375
							Height=0.608542
							ShapeType=Circle
							FillColor=Yellow
							FillStyle=Normal
						End
						Item
							Type=ShapeBox
							Name='RedShapeBox'
							BackColor=White
							Left=1.79917
							Top=0.608542
							Width=0.79375
							Height=0.608542
							ShapeType=Circle
							FillColor=Red
							FillStyle=Normal
						End
						Item
							Type=PictureBox
							Name='PictureBox1'
							Width=1.40229
							Height=1.19063
						End
					End
				End
			End
		End
	End
	Items Parameter
		Item
			Name='Catalog'
		End
		Item
			Name='CatalogNo'
			DataType=Integer
		End
		Item
			Name='Comment'
			Tag='报表说明'
			Value='通过写报表脚本实现：\r\n//报表数据按销售金额由大到小排序，根据销售金额，分类商品的销售状况\r\n//1、200000以上：抢手\r\n//2、15000-20000：畅销\r\n//3、5000-15000：一般\r\n//4、1000-5000：较差\r\n//5、1000以下：滞销\r\n//即使不存在某类商品，也要将此类别列出，这就需要生成没有明细的分组\r\n//实现手段主要是在报表事件中用StartNewGroup方法按条件产生分组\r\n\r\n'
		End
	End
	Items Section
		Item
			Type=PageHeader
			Height=1.00542
			Items Control
				Item
					Type=Line
					Name='Line1'
					Top=0.79375
					Width=16.1925
					PenWidth=2
				End
				Item
					Type=MemoBox
					Name='MemoBox3'
					Object Font
						Name='楷体_GB2312'
						Size=120000,0
						Bold=T
						Charset=134
					End
					Anchor=[Top|Right]
					Left=2.19604
					Top=0.211667
					Width=13.7054
					Height=0.47625
					Text='欢迎访问Grid++Report网站www.rubylong.cn，了解最新产品信息。'
				End
			End
		End
		Item
			Type=PageFooter
			Height=0.582083
			Items Control
				Item
					Type=MemoBox
					Name='MemoBox1'
					AlignColumn='Amount'
					Left=8.36083
					Width=4.41854
					Height=0.396875
					TextAlign=MiddleRight
					Text='共[#SystemVar(PageCount)#]页 第[#SystemVar(PageNumber)#]页'
				End
			End
		End
		Item
			Type=ReportHeader
			Height=1.37583
			Items Control
				Item
					Type=StaticBox
					Name='StaticBox1'
					Object Font
						Name='宋体'
						Size=150000,0
						Bold=T
						Charset=134
					End
					Center=Horizontal
					Left=4.92125
					Top=0.185208
					Width=6.19125
					Height=0.820208
					TextAlign=MiddleCenter
					Text='按销售额范围分类'
				End
			End
		End
		Item
			Type=ReportFooter
			Height=1.19063
			Object Font
				Name='宋体'
				Size=90000,0
				Bold=T
				Charset=134
			End
			Items Control
				Item
					Type=StaticBox
					Name='StaticBox8'
					AlignColumnSide=Right
					AlignColumn='ProductName'
					Left=6.37646
					Width=2.01083
					Height=0.582083
					TextAlign=MiddleRight
					Text='总金额：'
				End
				Item
					Type=SummaryBox
					Name='Summary5'
					AlignColumn='Amount'
					Left=8.36083
					Width=4.41854
					Height=0.582083
					TextAlign=MiddleRight
					DataField='销售金额'
					Format='$#,##0.00'
				End
				Item
					Type=SummaryBox
					Name='Summary6'
					AlignColumn='Amount'
					Left=8.36083
					Top=0.582083
					Width=4.41854
					Height=0.608542
					TextAlign=MiddleRight
					DataField='销售金额'
					SummaryFun=Avg
					Format='$#,##0.00'
				End
				Item
					Type=StaticBox
					Name='StaticBox9'
					AlignColumnSide=Right
					AlignColumn='ProductName'
					Left=6.37646
					Top=0.582083
					Width=2.01083
					Height=0.608542
					TextAlign=MiddleRight
					Text='平均金额：'
				End
				Item
					Type=MemoBox
					Name='MemoBox2'
					AlignColumn='ProductID'
					Width=3.81
					Height=0.608542
					Text='总产品个数：[#Count()#]'
				End
			End
		End
	End
End
 